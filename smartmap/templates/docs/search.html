{% extends 'smartmap/_layout' %}
{% set selectedTab = 'search' %}

{% set title = 'Search for Closest Locations'|t %}

{% set content %}

    <h2>Search Function</h2>

    <div class="function-definition">
        <h3><code>.myAddressField(params).order('distance')</code></h3>
        <div class="function-parameters"></div>
        <div class="function-returns">Returns a group of entries, sorted by closest proximity to target.</div>
        <div class="function-description"><strong>IMPORTANT:</strong> "myAddressField" should be replaced with the handle of the Smart Map field you are searching against.</div>
        <pre><code>{% verbatim -%}
{% set target = '90210' %}
{% set params = {
    target: target,
    range: 100
} %}

{% set entries = craft.entries.myAddressField(params).order('distance').find() %}

&lt;h1&gt;Showing results for "{{ target }}"...&lt;/h1&gt;
{% for entry in entries %}
    &lt;h2&gt;{{ entry.title }}&lt;/h2&gt;
    &lt;div&gt;
        {{ entry.myAddressField.street1 }}{{ entry.myAddressField.street2 ? ' '~entry.myAddressField.street2 }}&lt;br /&gt;
        {{ entry.myAddressField.city }}, {{ entry.myAddressField.state }} {{ entry.myAddressField.zip }}&lt;br&gt;
        &lt;strong&gt;{{ entry.myAddressField.distance | number_format(1) }} miles away&lt;/strong&gt;
    &lt;/div&gt;
{% else %}
    &lt;h2&gt;No results found&lt;/h2&gt;
{% endfor %}

        {%- endverbatim %}</code></pre>
    </div>

    <table class="parameters">
        <colgroup>
            <col width="90" />
            <col width="200" />
            <col width="*" />
        </colgroup>
        <tr>
            <th class="parameter">Parameter</th>
            <th class="default">Default</th>
            <th class="description">Description</th>
        </tr>
        <tr>
            <td class="parameter">target</td>
            <td class="default">(autodetects current location)</td>
            <td class="description">Starting point for proximity search</td>
        </tr>
        <tr>
            <td class="parameter">range</td>
            <td class="default">25</td>
            <td class="description">Search radius, measured in "units"</td>
        </tr>
        <tr>
            <td class="parameter">units</td>
            <td class="default">"miles"</td>
            <td class="description">Units of measurement ("miles" or "kilometers")</td>
        </tr>
    </table>

{% endset %}